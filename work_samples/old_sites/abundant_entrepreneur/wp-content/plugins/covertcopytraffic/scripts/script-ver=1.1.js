var IMWB_CC=function(h,c,e){var f,i=!!("object"==typeof c.selection&&c.selection),g=function(a,b){var c=typeof a[b];return"function"==c||!!("object"==c&&a[b])||"unknown"==c},k=function(a,b){g(a,"setBaseAndExtent")?a.setBaseAndExtent(b.startContainer,b.startOffset,b.endContainer,b.endOffset):g(a,"select")?a.select():g(a,"addRange")&&a.addRange(b)},m=function(){if(f)return!1;var a=e("<div></div>");a.css({overflow:"hidden",textAlign:"left",border:"none",position:"absolute",top:"-999px",height:"0px", width:"0px"});var b;b=i?c.selection.createRange():h.getSelection();if(!((i?e.trim(b.text).split(/\s+/g).length:0==b.rangeCount?-1:e.trim(b.toString()).split(/\s+/g).length)<IMWB_CPY_Options.aMinWords)){f=!0;if(i){var g=c.documentElement.scrollLeft,l=c.documentElement.scrollTop;"A"==IMWB_CPY_Options.aPlace?a.html(IMWB_CPY_Options.aText+"<br><br>"+b.htmlText):a.html(b.htmlText+"<br><br>"+IMWB_CPY_Options.aText);a.css("left",g+"px");a.css("top",l+"px");e("body").prepend(a);var d=c.body.createTextRange(); d.moveToElementText(a.get(0));d.select();h.setTimeout(function(){a.remove();k(b);c.documentElement.scrollLeft=g;c.documentElement.scrollTop=l;f=!1},0)}else{var j=b.getRangeAt(0);a.css("overflow","");a.html("<br>");e("body").append(a);d=e("<div></div>");d.css("backgroundColor","transparent");"A"==IMWB_CPY_Options.aPlace?(d.html(IMWB_CPY_Options.aText+"<br><br>"),d.append(j.cloneContents())):(d.append(j.cloneContents()),d.append("<br><br>"+IMWB_CPY_Options.aText));a.append(d);b.selectAllChildren(d.get(0)); h.setTimeout(function(){a.remove();k(b,j);f=!1},0)}f=!1}};return{init:function(){f=!1;e("body").bind("copy",m)}}}(window,document,jQuery);jQuery(document).ready(function(){IMWB_CC.init()});